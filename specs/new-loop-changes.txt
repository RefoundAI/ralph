Model strategy system (model-strategy.md) - COMPLETE. All R1-R11 tasks implemented and passing tests. CLI flags, Config fields, all four strategies (fixed, cost-optimized, escalate, plan-then-execute), Claude hint parsing, system prompt documentation, override logging, and --model flag integration all working.

Config.md R1-R3 DONE: Added src/project.rs with ProjectConfig discovery, RalphConfig/SpecsConfig/PromptsConfig structs with serde, defaults (.ralph/specs, .ralph/prompts), toml parsing with forward-compat. All 9 tests passing.

Config.md R4 DONE: Implemented `ralph init` subcommand. Creates .ralph.toml (commented defaults), .ralph/ directory structure (prompts/, specs/, progress.db), and .gitignore entry. Idempotent: skips existing .ralph.toml, appends to .gitignore without duplicates. Added Command subcommand enum to CLI, wired into main.rs. All 103 tests passing.

Config.md R5 DONE: Removed --specs-dir/RALPH_SPECS_DIR and --progress-file/RALPH_PROGRESS_FILE CLI flags from Args. Updated Config struct to remove progress_file and specs_dir fields, added project_root and ralph_config fields. Changed Config::from_args signature to accept ProjectConfig. Updated main.rs to call project::discover() before Config creation. Updated run_loop.rs to derive progress_db path from project_root. Fixed all test helpers in config.rs, cli.rs, claude/client.rs, and strategy.rs to use new ProjectConfig. All 103 tests passing.

loop-changes.md R1 DONE: Added Blocked and NoPlan variants to Outcome enum in run_loop.rs. Updated main.rs to handle new variants with exit codes 2 and 3 respectively. Added unit tests verifying all five Outcome variants exist and are properly distinguished. All 106 tests passing.

loop-changes.md R2 DONE: Added task_done and task_failed fields to ResultEvent struct. Implemented parse_task_done() and parse_task_failed() functions in events.rs that extract task IDs from sigils (whitespace trimmed, empty content rejected). Updated parser.rs to call parsing functions when building ResultEvent, with task_done winning if both sigils present. Added 14 comprehensive unit tests covering all cases (basic, with context, whitespace, malformed, empty, multiple sigils). All 120 tests passing.

loop-changes.md R3 DONE: Added agent_id field to Config struct. Implemented generate_agent_id() function using hash of timestamp and process ID, generating unique IDs in format agent-{8 hex chars}. Updated Config::from_args to call generate_agent_id(). Agent ID preserved across iterations via next_iteration(). Added 4 unit tests verifying format, uniqueness, and preservation. All 124 tests passing.

loop-changes.md R7 DONE: Created src/dag/mod.rs with stub implementations of DAG API: Db struct, Task struct, TaskCounts struct, and functions (open_db, get_ready_tasks, get_task_counts, claim_task, complete_task, fail_task, all_resolved, release_claim) with todo!() bodies. Functions compile and can be called. Added 2 unit tests verifying Task and TaskCounts structs. Registered dag module in main.rs. All 126 tests passing. Prerequisite for loop-changes.md R4.

loop-changes.md R4 DONE: Rewrote run() in run_loop.rs to implement DAG-driven loop. Replaces flat progress-file approach with SQLite DAG. Flow: 1) Open progress.db, 2) Print DAG summary on first iteration, 3) Get task counts & ready tasks, 4) Return NoPlan if DAG empty, Blocked if no ready tasks, 5) Claim first ready task, 6) Print iteration info, 7) Run Claude with task, 8) Parse task-done/task-failed sigils (task_done wins if both), 9) Update task status or release claim if no sigil, 10) Check all_resolved for Complete, 11) Check limit for LimitReached, 12) Loop. FAILURE sigil causes immediate return. Added 3 integration tests: empty_dag_returns_noplan, ready_tasks_are_picked_in_order (3-task dependency chain A->B->C), blocked_tasks_return_blocked_outcome. All 190 tests passing.
